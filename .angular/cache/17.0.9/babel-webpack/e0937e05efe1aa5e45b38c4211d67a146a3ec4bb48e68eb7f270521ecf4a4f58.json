{"ast":null,"code":"import _asyncToGenerator from \"E:/my-projects/Example_project/grocery-app/grocery-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component, ViewChild } from '@angular/core';\nlet HomePage = class HomePage {\n  constructor(videoService, changeDetector) {\n    this.videoService = videoService;\n    this.changeDetector = changeDetector;\n    this.isRecording = false;\n    this.videos = [];\n  }\n  ngAfterViewInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      _this.videos = yield _this.videoService.loadVideos();\n      // Initialise the video player plugin\n      if (Capacitor.isNative) {\n        _this.videoPlayer = CapacitorVideoPlayer;\n      } else {\n        _this.videoPlayer = WebVPPlugin.CapacitorVideoPlayer;\n      }\n    })();\n  }\n  recordVideo() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      // Create a stream of video capturing\n      const stream = yield navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'user'\n        },\n        audio: true\n      });\n      // Show the stream inside our video object\n      _this2.captureElement.nativeElement.srcObject = stream;\n      var options = {\n        mimeType: 'video/webm'\n      };\n      _this2.mediaRecorder = new MediaRecorder(stream, options);\n      let chunks = [];\n      // Store the video on stop\n      _this2.mediaRecorder.onstop = /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(function* (event) {\n          const videoBuffer = new Blob(chunks, {\n            type: 'video/webm'\n          });\n          yield _this2.videoService.storeVideo(videoBuffer);\n          // Reload our list\n          _this2.videos = _this2.videoService.videos;\n          _this2.changeDetector.detectChanges();\n        });\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }();\n      // Store chunks of recorded video\n      _this2.mediaRecorder.ondataavailable = event => {\n        if (event.data && event.data.size > 0) {\n          chunks.push(event.data);\n        }\n      };\n      // Start recording wth chunks of data\n      _this2.mediaRecorder.start(100);\n      _this2.isRecording = true;\n    })();\n  }\n  stopRecord() {\n    this.mediaRecorder.stop();\n    this.mediaRecorder = null;\n    this.captureElement.nativeElement.srcObject = null;\n    this.isRecording = false;\n  }\n  play(video) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      // Get the video as base64 data\n      const realUrl = yield _this3.videoService.getVideoUrl(video);\n      // Show the player fullscreen\n      yield _this3.videoPlayer.initPlayer({\n        mode: 'fullscreen',\n        url: realUrl,\n        playerId: 'fullscreen',\n        componentTag: 'app-home'\n      });\n    })();\n  }\n};\n__decorate([ViewChild('video')], HomePage.prototype, \"captureElement\", void 0);\nHomePage = __decorate([Component({\n  selector: 'app-home',\n  templateUrl: 'home.page.html',\n  styleUrls: ['home.page.scss']\n})], HomePage);\nexport { HomePage };","map":{"version":3,"names":["Component","ViewChild","HomePage","constructor","videoService","changeDetector","isRecording","videos","ngAfterViewInit","_this","_asyncToGenerator","loadVideos","Capacitor","isNative","videoPlayer","CapacitorVideoPlayer","WebVPPlugin","recordVideo","_this2","stream","navigator","mediaDevices","getUserMedia","video","facingMode","audio","captureElement","nativeElement","srcObject","options","mimeType","mediaRecorder","MediaRecorder","chunks","onstop","_ref","event","videoBuffer","Blob","type","storeVideo","detectChanges","_x","apply","arguments","ondataavailable","data","size","push","start","stopRecord","stop","play","_this3","realUrl","getVideoUrl","initPlayer","mode","url","playerId","componentTag","__decorate","selector","templateUrl","styleUrls"],"sources":["E:\\my-projects\\Example_project\\grocery-app\\grocery-app\\src\\app\\home\\home.page.ts"],"sourcesContent":["import { Component, ElementRef, ViewChild } from '@angular/core';\nimport { VedioserviceService } from '../vedioservice.service';\n\n@Component({\n  selector: 'app-home',\n  templateUrl: 'home.page.html',\n  styleUrls: ['home.page.scss'],\n})\nexport class HomePage {\n  @ViewChild('video') captureElement: ElementRef;\n  mediaRecorder: any;\n  videoPlayer: any;\n  isRecording = false;\n  videos :any[] = [];\n \n  constructor(public videoService: VideoService, private changeDetector: ChangeDetectorRef) {\n  }\n \n  async ngAfterViewInit() {\n    this.videos = await this.videoService.loadVideos();\n \n    // Initialise the video player plugin\n    if (Capacitor.isNative) {\n      this.videoPlayer = CapacitorVideoPlayer;\n    } else {\n      this.videoPlayer = WebVPPlugin.CapacitorVideoPlayer\n    }\n  }\n \n  async recordVideo() {\n    // Create a stream of video capturing\n    const stream = await navigator.mediaDevices.getUserMedia({\n      video: {\n        facingMode: 'user'\n      },\n      audio: true\n    });\n \n    // Show the stream inside our video object\n    this.captureElement.nativeElement.srcObject = stream;\n \n    var options = {mimeType: 'video/webm'};\n    this.mediaRecorder = new MediaRecorder(stream, options);\n    let chunks = [];\n \n    // Store the video on stop\n    this.mediaRecorder.onstop = async (event) => {\n      const videoBuffer = new Blob(chunks, { type: 'video/webm' });\n      await this.videoService.storeVideo(videoBuffer);\n      \n      // Reload our list\n      this.videos = this.videoService.videos;\n      this.changeDetector.detectChanges();\n    }\n \n    // Store chunks of recorded video\n    this.mediaRecorder.ondataavailable = (event) => {\n      if (event.data && event.data.size > 0) {\n        chunks.push(event.data)\n      }\n    }\n \n    // Start recording wth chunks of data\n    this.mediaRecorder.start(100);\n    this.isRecording = true;\n  }\n \n  stopRecord() {\n    this.mediaRecorder.stop();\n    this.mediaRecorder = null;\n    this.captureElement.nativeElement.srcObject = null;\n    this.isRecording = false;\n  }\n \n  async play(video) {\n    // Get the video as base64 data\n    const realUrl = await this.videoService.getVideoUrl(video);\n \n    // Show the player fullscreen\n    await this.videoPlayer.initPlayer({\n      mode: 'fullscreen',\n      url: realUrl,\n      playerId: 'fullscreen',\n      componentTag: 'app-home'\n    });    \n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}